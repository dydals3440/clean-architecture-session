# ğŸ›ï¸ í´ë¦° ì•„í‚¤í…ì²˜ë€ ë¬´ì—‡ì¼ê¹Œìš”?

## 1. í´ë¦° ì•„í‚¤í…ì²˜ë€?

- **í´ë¦° ì•„í‚¤í…ì²˜**ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ì—¬ëŸ¬ ì¸µ(ë ˆì´ì–´)ìœ¼ë¡œ ë‚˜ëˆ„ì–´, ê° ì¸µì´ ìê¸° ì—­í• ë§Œ í•˜ë„ë¡ ë§Œë“œëŠ” ì„¤ê³„ ë°©ë²•ì´ì—ìš”.
- ë§ˆì¹˜ í•™êµì—ì„œ ì„ ìƒë‹˜, í•™ìƒ, êµì¥ì„ ìƒë‹˜ì´ ê°ì ì—­í• ì´ ë‹¤ë¥´ë“¯, ì½”ë“œë„ ì—­í• ì„ ë‚˜ëˆ ì„œ ê´€ë¦¬í•´ìš”.

---

## 2. ì™œ ì´ë ‡ê²Œ ë‚˜ëˆŒê¹Œìš”?

- **ì½”ë“œê°€ ë³µì¡í•´ì ¸ë„** ì‰½ê²Œ ê³ ì¹˜ê³ , ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ ì¶”ê°€í•  ìˆ˜ ìˆì–´ìš”.
- **ì‹¤ìˆ˜ë¡œ ë‹¤ë¥¸ ì—­í• ì„ ì¹¨ë²”í•˜ëŠ” ê²ƒ**ì„ ë§‰ì•„ì¤˜ìš”.
- **í…ŒìŠ¤íŠ¸(ê²€ì‚¬)í•˜ê¸°ë„ ì‰¬ì›Œì ¸ìš”!**

---

## 3. ê° ë ˆì´ì–´(ì¸µ)ì˜ ì—­í• 

### 1) domain (ë„ë©”ì¸)

- **ì§„ì§œ ì¤‘ìš”í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™**ì´ ë“¤ì–´ìˆì–´ìš”.
- ì˜ˆì‹œ: ëŒ“ê¸€(Comment)ì´ë¼ëŠ” ê°œë…, ëŒ“ê¸€ì´ í•µì‹¬ ìœ ì €ì¸ì§€ íŒë‹¨í•˜ëŠ” ê·œì¹™ ë“±
- **ë‹¤ë¥¸ ë ˆì´ì–´ì— ì˜ì¡´í•˜ì§€ ì•Šì•„ìš”!**

### 2) application (ì• í”Œë¦¬ì¼€ì´ì…˜)

- **ë¬´ì—‡ì„ í• ì§€(ìœ ìŠ¤ì¼€ì´ìŠ¤)**ë¥¼ ì •ì˜í•´ìš”.
- ì˜ˆì‹œ: ëŒ“ê¸€ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°, ëŒ“ê¸€ í•˜ë‚˜ ê°€ì ¸ì˜¤ê¸° ë“±
- ë„ë©”ì¸ ëª¨ë¸ì„ ì‚¬ìš©í•´ì„œ ì‹¤ì œ ë™ì‘ì„ ë§Œë“¤ì–´ìš”.
- **validators**: ì‚¬ìš©ìê°€ ë³´ë‚¸ ë°ì´í„°ê°€ ì˜¬ë°”ë¥¸ì§€ "ëŸ°íƒ€ì„ì—" ê²€ì‚¬í•´ìš”. (ì˜ˆ: ìˆ«ìì¸ì§€, ë¹„ì–´ìˆì§€ ì•Šì€ì§€ ë“±)
- **mappers**: ë„ë©”ì¸ ëª¨ë¸ì„ í™”ë©´ì— ë³´ì—¬ì¤„ ë°ì´í„°(ViewModel)ë¡œ ë°”ê¿”ì¤˜ìš”.

### 3) infrastructure (ì¸í”„ë¼)

- **ì™¸ë¶€ì™€ ì—°ê²°**í•˜ëŠ” ì—­í• ì´ì—ìš”. (ì„œë²„, ë°ì´í„°ë² ì´ìŠ¤ ë“±)
- ì„œë²„ì—ì„œ ë°›ì€ ë°ì´í„°(DTO)ë¥¼ ë„ë©”ì¸ ëª¨ë¸ë¡œ ë°”ê¿”ì¤˜ìš”.
- **DTO(ë°ì´í„° ì „ì†¡ ê°ì²´)**: ì„œë²„ì—ì„œ ë°›ì€ ì›ë³¸ ë°ì´í„°, ì„œë²„ì—ì„œ "ê²€ì¦"ëœ ë°ì´í„°

### 4) presentation (í”„ë ˆì  í…Œì´ì…˜)

- **í™”ë©´ì— ë³´ì—¬ì£¼ëŠ” ë¶€ë¶„**ì´ì—ìš”.
- ViewModelë§Œ ì‚¬ìš©í•´ì„œ í™”ë©´ì„ ê·¸ë ¤ìš”.
- ë„ë©”ì¸, ì¸í”„ë¼ì— ì§ì ‘ ì ‘ê·¼í•˜ë©´ ì•ˆ ë¼ìš”!

---

## 4. ì™œ ë ˆì´ì–´ë¥¼ ì¹¨ë²”í•˜ë©´ ì•ˆ ë ê¹Œìš”?

- ê°ì ì—­í• ì´ ìˆëŠ”ë°, ë‹¤ë¥¸ ì—­í• ì„ ì¹¨ë²”í•˜ë©´ **ì½”ë“œê°€ ì—‰í‚¤ê³ , ê³ ì¹˜ê¸° ì–´ë ¤ì›Œì ¸ìš”.**
- ì˜ˆë¥¼ ë“¤ì–´, í™”ë©´ì—ì„œ ë°”ë¡œ ì„œë²„ ë°ì´í„°(DTO)ë¥¼ ì“°ë©´, ì„œë²„ê°€ ë°”ë€” ë•Œë§ˆë‹¤ í™”ë©´ë„ ë‹¤ ê³ ì³ì•¼ í•´ìš”.
- **ì˜ì¡´ì„± ë°©í–¥**: ë°”ê¹¥(ì¸í”„ë¼, í”„ë ˆì  í…Œì´ì…˜) â†’ ì•ˆìª½(ë„ë©”ì¸)ìœ¼ë¡œë§Œ ì˜ì¡´í•´ì•¼ í•´ìš”. (ì•ˆìª½ì€ ë°”ê¹¥ì„ ëª°ë¼ë„ ë¼ìš”!)

---

## 5. í…ŒìŠ¤íŠ¸ ì½”ë“œ ì§œê¸° ì¢‹ì€ ì´ìœ 

- ê° ë ˆì´ì–´ê°€ ë¶„ë¦¬ë˜ì–´ ìˆìœ¼ë‹ˆ, **ê°€ì§œ(ëª¨ì˜) ë°ì´í„°**ë¡œë„ ì‰½ê²Œ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆì–´ìš”.
- ì˜ˆë¥¼ ë“¤ì–´, ì„œë²„ ì—†ì´ë„ ë„ë©”ì¸, ì• í”Œë¦¬ì¼€ì´ì…˜ë§Œ ë”°ë¡œ ê²€ì‚¬í•  ìˆ˜ ìˆì–´ìš”.
- ì—­í• ì´ ë¶„ëª…í•˜ë‹ˆ, "ì´ ë¶€ë¶„ë§Œ" í…ŒìŠ¤íŠ¸í•˜ê¸°ê°€ ì‰¬ì›Œìš”.

---

## 6. ê°œë°œí•  ë•Œ ê¼­! ìœ ì˜í•  ì 

- **ë ˆì´ì–´ë¥¼ ì ˆëŒ€ ì¹¨ë²”í•˜ì§€ ë§ˆì„¸ìš”!** (ì˜ˆ: í™”ë©´ì—ì„œ ë„ë©”ì¸/ì¸í”„ë¼ ì§ì ‘ ì ‘ê·¼ ê¸ˆì§€)
- **ì˜ì¡´ì„± ë°©í–¥**ì„ í•­ìƒ ì§€í‚¤ì„¸ìš”. (ë°–ì—ì„œ ì•ˆìœ¼ë¡œë§Œ)
- **DTOì™€ ViewModel, ë„ë©”ì¸ ëª¨ë¸**ì„ í—·ê°ˆë¦¬ì§€ ë§ˆì„¸ìš”.
- **ê²€ì¦ ìœ„ì¹˜**ë¥¼ êµ¬ë¶„í•˜ì„¸ìš”:
  - application/validators: ì‚¬ìš©ìê°€ ë³´ë‚¸ ë°ì´í„° "ëŸ°íƒ€ì„" ê²€ì‚¬
  - infrastructure/dto: ì„œë²„ì—ì„œ "ê²€ì¦"ëœ ë°ì´í„°
- **í…ŒìŠ¤íŠ¸ ì½”ë“œ**ë¥¼ ê¼­ ì‘ì„±í•˜ì„¸ìš”. (ë¶„ë¦¬ëœ êµ¬ì¡°ë¼ì„œ ì‰½ê³ , ì‹¤ìˆ˜ë„ ì¤„ì¼ ìˆ˜ ìˆì–´ìš”)

---

## 7. í•œëˆˆì— ë³´ëŠ” êµ¬ì¡°ë„

```mermaid
graph TD
  P[Presentation (í™”ë©´)] -->|ViewModel| A(Application)
  A -->|ë„ë©”ì¸ ëª¨ë¸| D(Domain)
  A -->|DTO ë³€í™˜| I(Infrastructure)
  I -->|ì„œë²„ í†µì‹ | S[ì„œë²„]

  style P fill:#f9f,stroke:#333,stroke-width:2px
  style A fill:#bbf,stroke:#333,stroke-width:2px
  style D fill:#bfb,stroke:#333,stroke-width:2px
  style I fill:#ffb,stroke:#333,stroke-width:2px
  style S fill:#eee,stroke:#333,stroke-width:2px
```

---

## 8. ì‹¤ì œ ì˜ˆì œ ì½”ë“œë¡œ ë³´ëŠ” í´ë¦° ì•„í‚¤í…ì²˜

### 1) ë„ë©”ì¸ ëª¨ë¸ (domain/models/Comment.ts)

```typescript
export interface CommentDto {
  id: number;
  body: string;
  postId: number;
  user: {
    id: number;
    username: string;
    fullName: string;
  };
}

export class Comment {
  public readonly fullName: string;

  constructor(private readonly commentDto: CommentDto) {
    this.fullName = commentDto.user.fullName;
  }

  get id() {
    return this.commentDto.id;
  }
  get body() {
    return this.commentDto.body;
  }
  get postId() {
    return this.commentDto.postId;
  }
  get user() {
    return this.commentDto.user;
  }

  isEmmaWilson(): boolean {
    return this.fullName === '(í•µì‹¬ ìœ ì €) Emma Wilson';
  }
}
```

### 2) ì¸í”„ë¼ í´ë¼ì´ì–¸íŠ¸ (infrastructure/apis/CommentClientImplements.ts)

```typescript
export class CommentClientImplements {
  async getAllComment(request) {
    // ì„œë²„ì—ì„œ ëŒ“ê¸€ ëª©ë¡ì„ ë°›ì•„ì˜¨ë‹¤ (ì—¬ê¸°ì„  ì˜ˆì‹œ)
    return {
      comments: [
        /* ì„œë²„ì—ì„œ ë°›ì€ ëŒ“ê¸€ DTO ë°°ì—´ */
      ],
    };
  }
}
```

### 3) ì„œë¹„ìŠ¤ (application/services/CommentService.ts)

```typescript
import { Comment } from '@/features/comment/domain/models/Comment';

export default class CommentService {
  constructor(private readonly commentClient) {}

  async getAllComment(request) {
    const { comments } = await this.commentClient.getAllComment(request);
    return comments.map((comment) => new Comment(comment));
  }
}
```

### 4) ë·°ëª¨ë¸ ë§¤í¼ (application/mappers/CommentViewModel.ts)

```typescript
import { Comment } from '@/features/comment/domain/models/Comment';

export interface CommentViewModel {
  id: number;
  body: string;
  postId: number;
  isEmmaWilson: boolean;
  user: { id: number; username: string; fullName: string };
}

export function mapToCommentViewModel(comment: Comment): CommentViewModel {
  return {
    id: comment.id,
    body: comment.body,
    postId: comment.postId,
    isEmmaWilson: comment.isEmmaWilson(),
    user: comment.user,
  };
}
```

### 5) í”„ë ˆì  í…Œì´ì…˜ (presentation/components/CommentView.tsx)

```tsx
import { mapToCommentViewModel } from '@/features/comment/application/mappers/CommentViewModel';

function CommentView({ comment }) {
  const viewModel = mapToCommentViewModel(comment);
  return (
    <div>
      <div>{viewModel.body}</div>
      <div>{viewModel.user.fullName}</div>
      {viewModel.isEmmaWilson && <span>ğŸŒŸ í•µì‹¬ ìœ ì €!</span>}
    </div>
  );
}
```

---

## 9. ì‹¤ì œ API ê¸°ë°˜ ê°œë°œ ìˆœì„œ ì˜ˆì‹œ

1. **API ëª…ì„¸ í™•ì¸** (ë°±ì—”ë“œì™€ í˜‘ì˜)
2. **infrastructure/dto/response**ì— ì„œë²„ ì‘ë‹µ íƒ€ì… ì •ì˜
3. **infrastructure/apis**ì— ì‹¤ì œ ì„œë²„ í†µì‹  í´ë¼ì´ì–¸íŠ¸ êµ¬í˜„
4. **domain/models**ì— ë„ë©”ì¸ ëª¨ë¸ êµ¬í˜„ (ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ í¬í•¨)
5. **application/services**ì— ìœ ìŠ¤ì¼€ì´ìŠ¤(ì„œë¹„ìŠ¤) êµ¬í˜„ (í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ë„ë©”ì¸ ëª¨ë¸ ìƒì„±)
6. **application/mappers**ì— ViewModel ë³€í™˜ í•¨ìˆ˜ êµ¬í˜„
7. **presentation**ì—ì„œ ViewModelë§Œ ì‚¬ìš©í•´ í™”ë©´ êµ¬í˜„
8. **application/validators**ì—ì„œ ì…ë ¥ê°’ ëŸ°íƒ€ì„ ê²€ì¦

---

## 10. TDD(í…ŒìŠ¤íŠ¸ ì£¼ë„ ê°œë°œ)ë¡œ ê°œë°œí•˜ëŠ” ìˆœì„œ ì˜ˆì‹œ

1. **í…ŒìŠ¤íŠ¸ ì½”ë“œë¶€í„° ì‘ì„±** (ì›í•˜ëŠ” ë™ì‘ì„ ë¯¸ë¦¬ ì½”ë“œë¡œ ì ìŒ)
2. **StubClient(ê°€ì§œ í´ë¼ì´ì–¸íŠ¸)**ë¥¼ ë§Œë“¤ì–´ ì‹¤ì œ ì„œë²„ ì—†ì´ í…ŒìŠ¤íŠ¸
3. **ë„ë©”ì¸/ì„œë¹„ìŠ¤/ë§¤í¼ ë“± ì‹¤ì œ ì½”ë“œ ì‘ì„±**
4. **í…ŒìŠ¤íŠ¸ê°€ í†µê³¼í•  ë•Œê¹Œì§€ ì½”ë“œ ìˆ˜ì •**
5. **ì‹¤ì œ ì„œë²„ í´ë¼ì´ì–¸íŠ¸ë¡œ êµì²´**

---

## 11. StubClientë¥¼ í™œìš©í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì˜ˆì‹œ

### 1) StubClient ë§Œë“¤ê¸°

```typescript
// tests/StubCommentClient.ts
export class StubCommentClient {
  async getAllComment(request) {
    return {
      comments: [
        {
          id: 1,
          body: 'í…ŒìŠ¤íŠ¸ ëŒ“ê¸€',
          postId: 123,
          user: {
            id: 1,
            username: 'emma',
            fullName: '(í•µì‹¬ ìœ ì €) Emma Wilson',
          },
        },
      ],
    };
  }
}
```

### 2) ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸ ì½”ë“œ

```typescript
import CommentService from '@/features/comment/application/services/CommentService';
import { StubCommentClient } from './StubCommentClient';

describe('CommentService', () => {
  it('í•µì‹¬ ìœ ì € ëŒ“ê¸€ì„ ì˜¬ë°”ë¥´ê²Œ ë°˜í™˜í•œë‹¤', async () => {
    const service = new CommentService(new StubCommentClient());
    const comments = await service.getAllComment({});
    expect(comments[0].isEmmaWilson()).toBe(true);
    expect(comments[0].body).toBe('í…ŒìŠ¤íŠ¸ ëŒ“ê¸€');
  });
});
```

---

## 12. ê²°ë¡ 

- **í´ë¦° ì•„í‚¤í…ì²˜**ëŠ” ì—­í• ì„ ë‚˜ëˆ ì„œ, ì‹¤ìˆ˜ë„ ì¤„ì´ê³ , ê³ ì¹˜ê¸°ë„ ì‰½ê³ , í…ŒìŠ¤íŠ¸ë„ ì‰¬ìš´ êµ¬ì¡°ì˜ˆìš”!
- ê°ì ì—­í• ë§Œ ì˜ ì§€í‚¤ë©´, ëˆ„êµ¬ë‚˜ ì‰½ê²Œ ê°œë°œí•  ìˆ˜ ìˆì–´ìš”!
- **StubClient**ë¡œ í…ŒìŠ¤íŠ¸í•˜ë©´ ì„œë²„ ì—†ì´ë„ ì•ˆì „í•˜ê²Œ ê°œë°œí•  ìˆ˜ ìˆì–´ìš”!

---

> **ì´ˆë“±í•™ìƒë„ ì´í•´í•  ìˆ˜ ìˆë„ë¡ ì‰½ê²Œ ì„¤ëª…í•´ë´¤ì–´ìš”!**
> ê¶ê¸ˆí•œ ì ì´ ìˆìœ¼ë©´ ì–¸ì œë“  ì§ˆë¬¸í•´ ì£¼ì„¸ìš” :)
